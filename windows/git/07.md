<h1>Git - Desfazendo um commit</h1>



No Git, existem **duas formas principais de desfazer um commit**:

| Comando        | Efeito                                                       | Observações                                                  |
| -------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **git reset**  | Desfaz o commit **modificando o histórico** do repositório. O commit é removido do histórico. | Use com cuidado, **especialmente em branches compartilhadas**, pois altera o histórico de todos. |
| **git revert** | Desfaz o commit **criando um novo commit** com as alterações revertidas. O histórico anterior **não é modificado**. | Indique o commit a ser revertido pelo seu **hash**. Seguro para branches compartilhadas. |

<br />

<h2>1. Exemplo prático com `git reset`</h2>



1. Desfaça o commit `"Meu terceiro commit"`, através do comando **git reset**:

```bash
git reset HEAD~1
```

<br />

> [!NOTE]
>
> ### O que é `HEAD~1`?
>
> No Git, o **HEAD** é um **ponteiro** que indica o commit atual no qual você está trabalhando. Ele normalmente aponta para o último commit da branch ativa.
>
> O `~1` é uma **sintaxe de referência relativa** que significa “o commit **pai** do HEAD atual”.
>
> - `HEAD~1` → um commit antes do HEAD atual (ou seja, o commit imediatamente anterior).
> - `HEAD~2` → dois commits antes do HEAD atual.
> - E assim por diante (`HEAD~n` → n commits antes do HEAD).
>
> <br />
>
> ### Exemplo prático
>
> Suponha que seu histórico de commits seja:
>
> ```bash
> Commit C3  <- HEAD
> Commit C2
> Commit C1
> ```
>
> - `HEAD` aponta para `C3`
> - `HEAD~1` aponta para `C2`
> - `HEAD~2` aponta para `C1`
>
> Se você executar:
>
> ```
> git reset HEAD~1
> ```
>
> O Git fará o seguinte:
>
> 1. Moverá o **HEAD** para apontar para `C2` (o commit anterior).
> 2. O commit `C3` será removido do histórico (no caso do `reset` padrão).
>
> <br />
>
> ### Observações importantes
>
> - `HEAD~1` é útil em comandos como `git reset` ou `git checkout` para voltar **temporariamente** ou **desfazer commits recentes**.
> - Sempre tenha cuidado: se estiver trabalhando em uma branch compartilhada, usar `git reset` com HEAD~1 **altera o histórico**, podendo causar conflitos com outros colaboradores.
> - Para desfazer commits sem modificar o histórico, prefira `git revert` ao invés de `git reset`.

<br />

2. Verifique o status do repositório:

```bash
git status
```

3. O arquivo **spring.txt** volta a ficar disponível para ser adicionado novamente, como mostra a imagem abaixo:

<div align="left"><img src="https://i.imgur.com/xETINlK.png" title="source: imgur.com" /></div>

4. Visualize o histórico:

```bash
git log
```

5. Observe na imagem abaixo, que o **HEAD** do Repositório Local volta a apontar para **"Meu segundo commit"**, indicando que o commit **Meu terceiro commit** foi desfeito:

<div align="left"><img src="https://i.imgur.com/esS7wBR.png" title="source: imgur.com" /></div>

<br />

> [!TIP]
>
> Para redefinir também o conteúdo da pasta de trabalho (perdendo alterações locais), use:
>
> ```bash
> git reset HEAD~1 --hard
> ```
>
> Este comando é **destrutivo**. Use com cautela.

<br />

6. Para refazer o commit **Meu terceiro commit**, você pode usar:

```bash
git commit -a -m "Meu terceiro commit"
```

<br />

> [!TIP]
>
> A opção **-a** adiciona automaticamente arquivos modificados rastreados, mas **não inclui novos arquivos**. 
>
> Para criar um commit com novos arquivos, use `git add .` explicitamente.

<br />

<h2>2. Exemplo prático com `git revert`</h2>



1. Desfaça o commit `"Meu terceiro commit"`pela **Hash**, através do comando **git revert**:

```bash
git revert 1866
```

2. O código **1866** são os 4 primeiros caracteres da **Hash** do commit que será revertido, como vemos na imagem abaixo:

<div align="left"><img src="https://i.imgur.com/zs7XYaE.png" title="source: imgur.com" /></div>

<br />

> [!WARNING]
>
> O Git permite usar os primeiros caracteres do SHA (mínimo de 4) desde que sejam únicos entre os commits existentes. Caso não sejam, será necessário usar mais caracteres.

<br />

3. O Git abrirá o **Visual Studio Code** para editar a mensagem do commit de reversão. Feche o editor para continuar.
4. Será exibida uma mensagem semelhante a imagem abaixo, confirmando a reversão do commit:

<div align="left"><img src="https://i.imgur.com/ntpTuRp.png" title="source: imgur.com" width="60%"/></div>

5. Confirme o status do repositório:

```bash
git status
```

6. O Git indicará que não há alterações pendentes, porque o revert cria um commit que **desfaz o commit anterior sem alterar o histórico**:

<div align="left"><img src="https://i.imgur.com/BOIgZ5Y.png" title="source: imgur.com" /></div>

7. Visualize o histórico de commits:

```bash
git log
```

15. Observe na imagem abaixo, que o **HEAD** agora aponta para o commit `"Revert Meu terceiro commit"`:

<div align="left"><img src="https://i.imgur.com/zRolqwV.png" title="source: imgur.com" /></div>

<br />

> [!IMPORTANT]
>
> Diferente do `git reset`, o `git revert` **não remove commits anteriores**, garantindo integridade do histórico.

<br />

<div align="left"><img src="https://i.imgur.com/fu9QxlT.png" title="source: imgur.com" width="25px"/> <a href="https://git-scm.com/docs/git-reset/pt_BR" target="_blank"><b>Documentação: <i>Git Reset</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/fu9QxlT.png" title="source: imgur.com" width="25px"/> <a href="https://git-scm.com/docs/git-revert/pt_BR" target="_blank"><b>Documentação: <i>Git Revert</i></b></a></div>

<br /><br />

<div align="left"><a href="../README.md"><img src="https://i.imgur.com/XMgF3gl.png" title="source: imgur.com" width="3%"/>Voltar</a></div>